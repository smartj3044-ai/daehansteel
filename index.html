<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 대한철강 고객만족도 조사</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary-color: #2c3e50; --accent-color: #3498db; --bg-color: #f3f4f6; }
        body { font-family: 'Noto Sans KR', sans-serif; background-color: var(--bg-color); margin: 0; padding: 20px; color: #333; line-height: 1.6; }
        .container { max-width: 680px; margin: 0 auto; background: white; padding: 40px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        h1 { text-align: center; color: var(--primary-color); margin-bottom: 40px; font-size: 26px; border-bottom: 2px solid var(--primary-color); padding-bottom: 20px; }
        h2 { margin-top: 40px; margin-bottom: 20px; font-size: 18px; color: var(--accent-color); font-weight: 700; border-left: 4px solid var(--accent-color); padding-left: 10px; }
        .form-group { margin-bottom: 25px; }
        label { display: block; margin-bottom: 8px; font-weight: 500; font-size: 15px; }
        input[type="text"], input[type="tel"], textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 14px; transition: border-color 0.3s; }
        input[type="text"]:focus, textarea:focus { border-color: var(--accent-color); outline: none; }
        textarea { height: 100px; resize: vertical; }
        
        /* 라디오 버튼 스타일 */
        .radio-group { display: flex; justify-content: space-between; gap: 5px; background: #f8f9fa; padding: 15px; border-radius: 8px; }
        .radio-item { display: flex; flex-direction: column; align-items: center; width: 100%; position: relative; }
        .radio-item input { margin-bottom: 5px; cursor: pointer; }
        .radio-item label { font-size: 12px; font-weight: normal; margin: 0; cursor: pointer; }

        button.submit-btn { width: 100%; background-color: var(--primary-color); color: white; padding: 16px; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 30px; transition: background 0.3s; }
        button.submit-btn:hover { background-color: #34495e; }
        button.submit-btn:disabled { background-color: #95a5a6; cursor: not-allowed; }
        
        .loading { display: none; text-align: center; margin-top: 15px; color: #666; font-size: 14px; }
        .required::after { content: " *"; color: red; }
    </style>
</head>
<body>

<div class="container">
    <h1>2025 대한철강<br>고객만족도 조사</h1>
    
    <form id="surveyForm">
        
        <h2>1. 기본 정보</h2>
        <div class="form-group"><label class="required">현장명</label><input type="text" name="siteName" required></div>
        <div class="form-group"><label class="required">건설사명</label><input type="text" name="company" required></div>
        <div class="form-group"><label>부서명</label><input type="text" name="dept"></div>
        <div class="form-group"><label class="required">담당자명</label><input type="text" name="managerName" required></div>
        <div class="form-group"><label>연락처</label><input type="tel" name="phone" placeholder="010-0000-0000"></div>

        <h2>2. 가공장 평가 및 서비스</h2>
        
        <div class="form-group">
            <label>1. 요청 납기를 준수하였는가? (1~5)</label>
            <div class="radio-group">
                <div class="radio-item"><input type="radio" name="q1" value="1"><label>1</label></div>
                <div class="radio-item"><input type="radio" name="q1" value="2"><label>2</label></div>
                <div class="radio-item"><input type="radio" name="q1" value="3"><label>3</label></div>
                <div class="radio-item"><input type="radio" name="q1" value="4"><label>4</label></div>
                <div class="radio-item"><input type="radio" name="q1" value="5"><label>5</label></div>
            </div>
        </div>

        <div class="form-group"><label>2. 긴급발주에 적극 대응하였는가?</label>
            <div class="radio-group">
                <div class="radio-item"><input type="radio" name="q2" value="1"><label>1</label></div>
                <div class="radio-item"><input type="radio" name="q2" value="2"><label>2</label></div>
                <div class="radio-item"><input type="radio" name="q2" value="3"><label>3</label></div>
                <div class="radio-item"><input type="radio" name="q2" value="4"><label>4</label></div>
                <div class="radio-item"><input type="radio" name="q2" value="5"><label>5</label></div>
            </div>
        </div>

        <div class="form-group"><label>3. 송장과 실제 입고 제품이 일치하였는가?</label>
            <div class="radio-group">
                 <div class="radio-item"><input type="radio" name="q3" value="1"><label>1</label></div>
                 <div class="radio-item"><input type="radio" name="q3" value="2"><label>2</label></div>
                 <div class="radio-item"><input type="radio" name="q3" value="3"><label>3</label></div>
                 <div class="radio-item"><input type="radio" name="q3" value="4"><label>4</label></div>
                 <div class="radio-item"><input type="radio" name="q3" value="5"><label>5</label></div>
            </div>
        </div>

        <div class="form-group"><label>4. 오가공/오출고를 최소화하였는가?</label>
            <div class="radio-group">
                 <div class="radio-item"><input type="radio" name="q4" value="1"><label>1</label></div>
                 <div class="radio-item"><input type="radio" name="q4" value="2"><label>2</label></div>
                 <div class="radio-item"><input type="radio" name="q4" value="3"><label>3</label></div>
                 <div class="radio-item"><input type="radio" name="q4" value="4"><label>4</label></div>
                 <div class="radio-item"><input type="radio" name="q4" value="5"><label>5</label></div>
            </div>
        </div>
        <div class="form-group"><label>4-1. 오가공 물량 유형 (해당 시)</label><input type="text" name="q4_1"></div>

        <div class="form-group"><label>5. 누락 없이 납품되었는가?</label>
            <div class="radio-group">
                 <div class="radio-item"><input type="radio" name="q5" value="1"><label>1</label></div>
                 <div class="radio-item"><input type="radio" name="q5" value="2"><label>2</label></div>
                 <div class="radio-item"><input type="radio" name="q5" value="3"><label>3</label></div>
                 <div class="radio-item"><input type="radio" name="q5" value="4"><label>4</label></div>
                 <div class="radio-item"><input type="radio" name="q5" value="5"><label>5</label></div>
            </div>
        </div>

        <div class="form-group"><label>6. 하차 시 적재 안전에 유의하였는가?</label>
             <div class="radio-group">
                 <div class="radio-item"><input type="radio" name="q6" value="1"><label>1</label></div>
                 <div class="radio-item"><input type="radio" name="q6" value="2"><label>2</label></div>
                 <div class="radio-item"><input type="radio" name="q6" value="3"><label>3</label></div>
                 <div class="radio-item"><input type="radio" name="q6" value="4"><label>4</label></div>
                 <div class="radio-item"><input type="radio" name="q6" value="5"><label>5</label></div>
            </div>
        </div>
        <div class="form-group"><label>6-1. 적재 불량 유형 (해당 시)</label><input type="text" name="q6_1" placeholder="예: 밴딩 상태, 받침목 등"></div>

        <div class="form-group"><label>7. 포장 결속은 양호하였는가?</label>
             <div class="radio-group">
                 <div class="radio-item"><input type="radio" name="q7" value="1"><label>1</label></div>
                 <div class="radio-item"><input type="radio" name="q7" value="2"><label>2</label></div>
                 <div class="radio-item"><input type="radio" name="q7" value="3"><label>3</label></div>
                 <div class="radio-item"><input type="radio" name="q7" value="4"><label>4</label></div>
                 <div class="radio-item"><input type="radio" name="q7" value="5"><label>5</label></div>
            </div>
        </div>
        <div class="form-group"><label>7-1. 포장 불량 유형 (해당 시)</label><input type="text" name="q7_1"></div>

        <div class="form-group"><label>8. 소운반 대응 (만족도 및 의견)</label><input type="text" name="q8" placeholder="소운반 관련 의견"></div>

        <div class="form-group"><label>9. 내진용철근 및 커플러 납기 관리</label>
             <div class="radio-group">
                 <div class="radio-item"><input type="radio" name="q9" value="1"><label>1</label></div>
                 <div class="radio-item"><input type="radio" name="q9" value="2"><label>2</label></div>
                 <div class="radio-item"><input type="radio" name="q9" value="3"><label>3</label></div>
                 <div class="radio-item"><input type="radio" name="q9" value="4"><label>4</label></div>
                 <div class="radio-item"><input type="radio" name="q9" value="5"><label>5</label></div>
            </div>
        </div>

        <div class="form-group"><label>10. 담당자 주기적 현장방문 및 대응력</label><input type="text" name="q10" placeholder="방문 빈도 및 태도 등"></div>

        <h2>3. SHOP DWG 납기 및 품질</h2>
        <div class="form-group"><label>11. 사전 납품 협의 시 SHOP 방침 협의를 진행하였는가?</label>
             <div class="radio-group">
                 <div class="radio-item"><input type="radio" name="q11" value="1"><label>1</label></div>
                 <div class="radio-item"><input type="radio" name="q11" value="2"><label>2</label></div>
                 <div class="radio-item"><input type="radio" name="q11" value="3"><label>3</label></div>
                 <div class="radio-item"><input type="radio" name="q11" value="4"><label>4</label></div>
                 <div class="radio-item"><input type="radio" name="q11" value="5"><label>5</label></div>
            </div>
        </div>
        <div class="form-group"><label>12. 담당자 건축/구조도면 이해도 및 소통</label>
             <div class="radio-group">
                 <div class="radio-item"><input type="radio" name="q12" value="1"><label>1</label></div>
                 <div class="radio-item"><input type="radio" name="q12" value="2"><label>2</label></div>
                 <div class="radio-item"><input type="radio" name="q12" value="3"><label>3</label></div>
                 <div class="radio-item"><input type="radio" name="q12" value="4"><label>4</label></div>
                 <div class="radio-item"><input type="radio" name="q12" value="5"><label>5</label></div>
            </div>
        </div>
        <div class="form-group"><label>13. 건축 및 구조도면 관련 사전 점검 진행</label>
             <div class="radio-group">
                 <div class="radio-item"><input type="radio" name="q13" value="1"><label>1</label></div>
                 <div class="radio-item"><input type="radio" name="q13" value="2"><label>2</label></div>
                 <div class="radio-item"><input type="radio" name="q13" value="3"><label>3</label></div>
                 <div class="radio-item"><input type="radio" name="q13" value="4"><label>4</label></div>
                 <div class="radio-item"><input type="radio" name="q13" value="5"><label>5</label></div>
            </div>
        </div>
        <div class="form-group"><label>14. SHOP DWG 납기일정 준수</label>
             <div class="radio-group">
                 <div class="radio-item"><input type="radio" name="q14" value="1"><label>1</label></div>
                 <div class="radio-item"><input type="radio" name="q14" value="2"><label>2</label></div>
                 <div class="radio-item"><input type="radio" name="q14" value="3"><label>3</label></div>
                 <div class="radio-item"><input type="radio" name="q14" value="4"><label>4</label></div>
                 <div class="radio-item"><input type="radio" name="q14" value="5"><label>5</label></div>
            </div>
        </div>
        <div class="form-group"><label>15. 수정 및 설계변경 관련 적극적 대응</label>
             <div class="radio-group">
                 <div class="radio-item"><input type="radio" name="q15" value="1"><label>1</label></div>
                 <div class="radio-item"><input type="radio" name="q15" value="2"><label>2</label></div>
                 <div class="radio-item"><input type="radio" name="q15" value="3"><label>3</label></div>
                 <div class="radio-item"><input type="radio" name="q15" value="4"><label>4</label></div>
                 <div class="radio-item"><input type="radio" name="q15" value="5"><label>5</label></div>
            </div>
        </div>

        <h2>4. 개선 요청 사항 (자유 기재)</h2>
        <div class="form-group"><label>원가 절감 및 서비스 대응 관련</label><textarea name="opinion1" placeholder="예: 전산 시스템, 도면 공유 등"></textarea></div>
        <div class="form-group"><label>가공철근 납기 및 품질 관련</label><textarea name="opinion2" placeholder="예: 수정 수주 시 대응 등"></textarea></div>
        <div class="form-group"><label>SHOP 납기 및 품질 관련</label><textarea name="opinion3" placeholder="예: 복잡부 분류 작성 등"></textarea></div>
        <div class="form-group"><label>타사와의 차별화 / 기타 의견</label><textarea name="opinion4" placeholder="자유롭게 작성해주세요."></textarea></div>

        <button type="submit" class="submit-btn" id="submitBtn">설문 제출하기</button>
        <div class="loading" id="loadingMsg">소중한 의견을 전송하고 있습니다...<br>잠시만 기다려주세요.</div>
    </form>
</div>

<script>
    // [확인] 대표님이 주신 최종 URL 적용 완료
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwpJTJWzxL_x1JUSRGiYlcrx1pbo-oT5FkTBkC9gi7-MeBE064JBmv4BMROzmRyRL3b/exec";

    const form = document.getElementById('surveyForm');
    const submitBtn = document.getElementById('submitBtn');
    const loadingMsg = document.getElementById('loadingMsg');

    form.addEventListener('submit', function(e) {
        e.preventDefault();

        // 중복 제출 방지
        submitBtn.disabled = true;
        submitBtn.innerText = "전송 중...";
        loadingMsg.style.display = "block";

        const formData = new FormData(form);
        const data = {};
        formData.forEach((value, key) => data[key] = value);

        fetch(SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors', // 구글 앱스 스크립트 전송 필수 모드
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        })
        .then(() => {
            alert("✅ 설문이 성공적으로 제출되었습니다!\n참여해 주셔서 감사합니다.");
            window.location.reload(); // 새로고침
        })
        .catch(error => {
            console.error('Error:', error);
            alert("❌ 전송 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.");
            submitBtn.disabled = false;
            submitBtn.innerText = "설문 제출하기";
            loadingMsg.style.display = "none";
        });
    });
</script>

</body>
</html>
