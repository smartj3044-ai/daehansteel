<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 대한철강 고객만족도 조사</title>
    <style>
        /* [스타일] 깔끔하고 모바일에서 보기 편한 디자인 */
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f5f7fa;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 24px;
        }
        h2 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 30px;
            font-size: 18px;
            color: #3498db;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 14px;
        }
        input[type="text"], input[type="tel"], textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            box-sizing: border-box; /* 패딩 포함 크기 계산 */
            font-size: 14px;
        }
        .radio-group {
            display: flex;
            justify-content: space-between;
            background: #f9f9f9;
            padding: 10px;
            border-radius: 6px;
        }
        .radio-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 12px;
        }
        .radio-item input {
            margin-bottom: 5px;
        }
        textarea {
            height: 80px;
            resize: vertical;
        }
        button.submit-btn {
            width: 100%;
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.3s;
        }
        button.submit-btn:hover {
            background-color: #34495e;
        }
        .loading {
            display: none;
            text-align: center;
            color: #666;
            margin-top: 10px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>2025 대한철강<br>고객만족도 조사</h1>
    
    <form id="surveyForm">
        
        <h2>1. 기본 정보</h2>
        <div class="form-group">
            <label>현장명</label>
            <input type="text" name="siteName" placeholder="예: 서울 강남 A타워" required>
        </div>
        <div class="form-group">
            <label>건설사명</label>
            <input type="text" name="company" placeholder="예: OO건설" required>
        </div>
        <div class="form-group">
            <label>부서명</label>
            <input type="text" name="dept" placeholder="예: 공무팀">
        </div>
        <div class="form-group">
            <label>담당자명</label>
            <input type="text" name="managerName" placeholder="성함을 입력해주세요" required>
        </div>
        <div class="form-group">
            <label>연락처</label>
            <input type="tel" name="phone" placeholder="010-0000-0000">
        </div>

        <h2>2. 가공장 평가 및 서비스</h2>
        
        <div class="form-group">
            <label>1. 요청 납기를 준수하였는가? (1~5점)</label>
            <div class="radio-group">
                <div class="radio-item"><input type="radio" name="q1" value="1">1</div>
                <div class="radio-item"><input type="radio" name="q1" value="2">2</div>
                <div class="radio-item"><input type="radio" name="q1" value="3">3</div>
                <div class="radio-item"><input type="radio" name="q1" value="4">4</div>
                <div class="radio-item"><input type="radio" name="q1" value="5">5</div>
            </div>
        </div>

        <div class="form-group">
            <label>6-1. 적재 불량 유형 (해당 시 기재)</label>
            <input type="text" name="q6_1" placeholder="예: 밴딩 상태 불량 등">
        </div>

        <div class="form-group">
            <label>8. 소운반 대응 (만족도 혹은 내용)</label>
             <input type="text" name="q8" placeholder="소운반 관련 의견을 적어주세요">
        </div>

        <div class="form-group">
            <label>10. 담당자 현장 방문 및 대응력</label>
             <input type="text" name="q10" placeholder="현장 방문 빈도 및 태도 등">
        </div>


        <h2>3. SHOP DWG 납기 및 품질</h2>
        <div class="form-group">
            <label>11. SHOP 협의를 원활히 진행하였는가? (1~5점)</label>
            <div class="radio-group">
                <div class="radio-item"><input type="radio" name="q11" value="1">1</div>
                <div class="radio-item"><input type="radio" name="q11" value="2">2</div>
                <div class="radio-item"><input type="radio" name="q11" value="3">3</div>
                <div class="radio-item"><input type="radio" name="q11" value="4">4</div>
                <div class="radio-item"><input type="radio" name="q11" value="5">5</div>
            </div>
        </div>
        <h2>4. 개선 요청 사항</h2>
        <div class="form-group">
            <label>원가 절감 및 서비스 대응 관련</label>
            <textarea name="opinion1"></textarea>
        </div>
        <div class="form-group">
            <label>기타 의견</label>
            <textarea name="opinion4"></textarea>
        </div>

        <button type="submit" class="submit-btn" id="submitBtn">설문 제출하기</button>
        <div class="loading" id="loadingMsg">데이터를 전송 중입니다... 잠시만 기다려주세요.</div>

    </form>
</div>

<script>
    // [중요] 대표님이 보내주신 새로운 스크립트 주소
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyYDKn5oPLBK6p2sGaa7_Qa9LFcJKWyzJ-ksJ7zG_RrhLCEoQC_x48VSZFS6jeFsb65/exec";

    const form = document.getElementById('surveyForm');
    const submitBtn = document.getElementById('submitBtn');
    const loadingMsg = document.getElementById('loadingMsg');

    form.addEventListener('submit', function(e) {
        e.preventDefault(); // 화면 새로고침 방지

        // 1. 버튼 비활성화 (중복 제출 방지)
        submitBtn.disabled = true;
        submitBtn.innerText = "전송 중...";
        loadingMsg.style.display = "block";

        // 2. 폼 데이터 가져오기
        const formData = new FormData(form);
        const data = {};
        
        // 3. 데이터를 객체로 변환
        formData.forEach((value, key) => {
            data[key] = value;
        });

        // 4. 구글 시트로 전송 (fetch)
        fetch(SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors', // 구글 스크립트로 보낼 때 필수 설정
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
        })
        .then(() => {
            // no-cors 모드에서는 응답 내용을 읽을 수 없으므로, 전송 완료되면 성공으로 간주
            alert("설문이 성공적으로 제출되었습니다!\n소중한 의견 감사합니다.");
            form.reset(); // 폼 초기화
            window.location.reload(); // 깔끔하게 새로고침
        })
        .catch(error => {
            console.error('Error:', error);
            alert("전송 중 오류가 발생했습니다. 다시 시도해주세요.");
        })
        .finally(() => {
            submitBtn.disabled = false;
            submitBtn.innerText = "설문 제출하기";
            loadingMsg.style.display = "none";
        });
    });
</script>

</body>
</html>
